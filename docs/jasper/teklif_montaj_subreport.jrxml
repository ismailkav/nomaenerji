<?xml version="1.0" encoding="UTF-8"?>
<!--
  Data source: JSON array `montaj_satirlari` (flat list).

  Grouping:
  - Outer group: line_sira (offer line)
  - Inner group header: montaj_grup_kod
-->
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports"
              xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
              xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd"
              name="teklif_montaj_subreport"
              pageWidth="595"
              pageHeight="842"
              columnWidth="555"
              leftMargin="20"
              rightMargin="20"
              topMargin="20"
              bottomMargin="20"
              uuid="2c4b2e2b-14e5-4b3d-90f3-4a9c79d3f6f4">

    <field name="line_sira" class="java.lang.Integer"/>
    <field name="stok_kod" class="java.lang.String"/>
    <field name="stok_aciklama" class="java.lang.String"/>

    <field name="montaj_grup_kod" class="java.lang.String"/>

    <field name="sirano" class="java.lang.Integer"/>
    <field name="urun_kod" class="java.lang.String"/>
    <field name="urun_aciklama" class="java.lang.String"/>
    <field name="birim" class="java.lang.String"/>
    <field name="miktar" class="java.lang.Double"/>
    <field name="birim_fiyat" class="java.lang.Double"/>
    <field name="doviz" class="java.lang.String"/>
    <field name="satir_tutar" class="java.lang.Double"/>

    <variable name="MontajGrupSira" class="java.lang.Integer" calculation="Count"
              resetType="Group" resetGroup="LineGroup"
              incrementType="Group" incrementGroup="MontajGrupGroup">
        <variableExpression><![CDATA[1]]></variableExpression>
    </variable>

    <title>
        <band height="26">
            <staticText>
                <reportElement x="0" y="0" width="555" height="26" uuid="f09765f6-4f56-4c22-a62c-2f05247c82d8"/>
                <textElement textAlignment="Center" verticalAlignment="Middle">
                    <font size="12" isBold="true"/>
                </textElement>
                <text><![CDATA[MONTAJ DETAY]]></text>
            </staticText>
        </band>
    </title>

    <group name="LineGroup">
        <groupExpression><![CDATA[$F{line_sira}]]></groupExpression>
        <groupHeader>
            <band height="18">
                <textField>
                    <reportElement x="0" y="0" width="555" height="18" uuid="e6c2a313-0a3c-4b9c-9e5f-d7bf6e0486cb"/>
                    <textElement verticalAlignment="Middle">
                        <font size="9" isBold="true"/>
                    </textElement>
                    <textFieldExpression><![CDATA[
                        "Satır " + String.valueOf($F{line_sira} == null ? "" : $F{line_sira})
                        + " - " + ($F{stok_kod} == null ? "" : $F{stok_kod})
                        + " - " + ($F{stok_aciklama} == null ? "" : $F{stok_aciklama})
                    ]]></textFieldExpression>
                </textField>
            </band>
        </groupHeader>
    </group>

    <group name="MontajGrupGroup">
        <groupExpression><![CDATA[
            ($F{montaj_grup_kod} == null || $F{montaj_grup_kod}.trim().isEmpty())
                ? "DİĞER"
                : $F{montaj_grup_kod}.trim()
        ]]></groupExpression>
        <groupHeader>
            <band height="20">
                <rectangle>
                    <reportElement x="0" y="0" width="35" height="20" mode="Opaque" backcolor="#FFFFFF" uuid="b03a0a55-9a4f-4d05-a98d-81e716a10d85"/>
                    <graphicElement>
                        <pen lineWidth="1.0" lineColor="#000000"/>
                    </graphicElement>
                </rectangle>
                <rectangle>
                    <reportElement x="35" y="0" width="520" height="20" mode="Opaque" backcolor="#E7C3C3" uuid="7a6d8f6f-7f91-43d6-b4d5-0fa1ea0890ad"/>
                    <graphicElement>
                        <pen lineWidth="1.0" lineColor="#000000"/>
                    </graphicElement>
                </rectangle>

                <textField>
                    <reportElement x="0" y="0" width="35" height="20" uuid="a8dfd77d-46f8-4d9e-8aef-5229c0789a40"/>
                    <textElement textAlignment="Center" verticalAlignment="Middle">
                        <font size="9" isBold="true"/>
                    </textElement>
                    <textFieldExpression><![CDATA[$V{MontajGrupSira}]]></textFieldExpression>
                </textField>
                <textField>
                    <reportElement x="35" y="0" width="520" height="20" uuid="7c3909dd-3b4a-42fa-9b93-cb6c5450e9ea"/>
                    <textElement textAlignment="Center" verticalAlignment="Middle">
                        <font size="9" isBold="true"/>
                    </textElement>
                    <textFieldExpression><![CDATA[
                        ($F{montaj_grup_kod} == null || $F{montaj_grup_kod}.trim().isEmpty())
                            ? "DİĞER"
                            : $F{montaj_grup_kod}.trim()
                    ]]></textFieldExpression>
                </textField>
            </band>
        </groupHeader>
    </group>

    <columnHeader>
        <band height="18">
            <rectangle>
                <reportElement x="0" y="0" width="555" height="18" mode="Opaque" backcolor="#F3F4F6" uuid="0b07cdb0-5a03-4a5c-a6db-14e317a4f2dc"/>
                <graphicElement>
                    <pen lineWidth="1.0" lineColor="#000000"/>
                </graphicElement>
            </rectangle>

            <rectangle>
                <reportElement x="0" y="0" width="35" height="18" uuid="0e4e0b2a-2c2f-4c27-937b-9d7b3e9a0e37"/>
                <graphicElement><pen lineWidth="1.0" lineColor="#000000"/></graphicElement>
            </rectangle>
            <rectangle>
                <reportElement x="35" y="0" width="270" height="18" uuid="7c424dfe-8fb6-459f-9b87-237d5df4b238"/>
                <graphicElement><pen lineWidth="1.0" lineColor="#000000"/></graphicElement>
            </rectangle>
            <rectangle>
                <reportElement x="305" y="0" width="55" height="18" uuid="1da7d7a5-29bf-4d59-8e0b-efb0a594b6e9"/>
                <graphicElement><pen lineWidth="1.0" lineColor="#000000"/></graphicElement>
            </rectangle>
            <rectangle>
                <reportElement x="360" y="0" width="55" height="18" uuid="e7d2f41c-55c2-4cc6-89f1-456fd7c8a2e0"/>
                <graphicElement><pen lineWidth="1.0" lineColor="#000000"/></graphicElement>
            </rectangle>
            <rectangle>
                <reportElement x="415" y="0" width="70" height="18" uuid="c7e1b1a4-07ed-45cf-8d33-1dd68b1fd860"/>
                <graphicElement><pen lineWidth="1.0" lineColor="#000000"/></graphicElement>
            </rectangle>
            <rectangle>
                <reportElement x="485" y="0" width="70" height="18" uuid="1208da7b-4292-433c-a4ce-41c91e47b65f"/>
                <graphicElement><pen lineWidth="1.0" lineColor="#000000"/></graphicElement>
            </rectangle>

            <staticText>
                <reportElement x="0" y="0" width="35" height="18" uuid="0b59e89e-1d0e-4d4e-9af0-20bd12e7fc0c"/>
                <textElement textAlignment="Center" verticalAlignment="Middle"><font size="8" isBold="true"/></textElement>
                <text><![CDATA[]]></text>
            </staticText>
            <staticText>
                <reportElement x="35" y="0" width="270" height="18" uuid="b37267bf-9a70-4a70-8804-0f6cf9c6f679"/>
                <textElement verticalAlignment="Middle"><font size="8" isBold="true"/></textElement>
                <text><![CDATA[Tanımlama]]></text>
            </staticText>
            <staticText>
                <reportElement x="305" y="0" width="55" height="18" uuid="3a8d01f3-2b95-4cdb-8d19-93f86c42cc36"/>
                <textElement textAlignment="Right" verticalAlignment="Middle"><font size="8" isBold="true"/></textElement>
                <text><![CDATA[Miktar]]></text>
            </staticText>
            <staticText>
                <reportElement x="360" y="0" width="55" height="18" uuid="51a06d4f-2a18-4c29-9029-70a7f6f997d6"/>
                <textElement textAlignment="Center" verticalAlignment="Middle"><font size="8" isBold="true"/></textElement>
                <text><![CDATA[Birim]]></text>
            </staticText>
            <staticText>
                <reportElement x="415" y="0" width="70" height="18" uuid="3ec54f90-2b37-4bd7-ae60-6a55fb68d478"/>
                <textElement textAlignment="Right" verticalAlignment="Middle"><font size="8" isBold="true"/></textElement>
                <text><![CDATA[Birim Fiyat]]></text>
            </staticText>
            <staticText>
                <reportElement x="485" y="0" width="70" height="18" uuid="9b55b4b0-8f3b-4bdc-9fd2-2f8a775f792a"/>
                <textElement textAlignment="Right" verticalAlignment="Middle"><font size="8" isBold="true"/></textElement>
                <text><![CDATA[Toplam]]></text>
            </staticText>
        </band>
    </columnHeader>

    <detail>
        <band height="18">
            <rectangle>
                <reportElement x="0" y="0" width="35" height="18" uuid="d3e1371d-22d7-4491-8c2a-4b0520de62e0"/>
                <graphicElement><pen lineWidth="1.0" lineColor="#000000"/></graphicElement>
            </rectangle>
            <rectangle>
                <reportElement x="35" y="0" width="270" height="18" uuid="e7f83af1-d4a8-4d65-b1bf-aeac7fd0bf9e"/>
                <graphicElement><pen lineWidth="1.0" lineColor="#000000"/></graphicElement>
            </rectangle>
            <rectangle>
                <reportElement x="305" y="0" width="55" height="18" uuid="a821dd6c-fd70-4e7b-9f0a-c2db3e4967a5"/>
                <graphicElement><pen lineWidth="1.0" lineColor="#000000"/></graphicElement>
            </rectangle>
            <rectangle>
                <reportElement x="360" y="0" width="55" height="18" uuid="ab6aa1c7-c5d8-43af-8a89-1883b26329ab"/>
                <graphicElement><pen lineWidth="1.0" lineColor="#000000"/></graphicElement>
            </rectangle>
            <rectangle>
                <reportElement x="415" y="0" width="70" height="18" uuid="5c8fe585-4419-4b55-a569-967a21f4147d"/>
                <graphicElement><pen lineWidth="1.0" lineColor="#000000"/></graphicElement>
            </rectangle>
            <rectangle>
                <reportElement x="485" y="0" width="70" height="18" uuid="24dced37-a0a8-4de9-9d95-2b25a7b04ccc"/>
                <graphicElement><pen lineWidth="1.0" lineColor="#000000"/></graphicElement>
            </rectangle>

            <textField>
                <reportElement x="0" y="0" width="35" height="18" uuid="b2bbdad2-40b7-4b85-98e5-b2c3c9d6b0da"/>
                <textElement textAlignment="Center" verticalAlignment="Middle"><font size="8"/></textElement>
                <textFieldExpression><![CDATA[]]></textFieldExpression>
            </textField>

            <textField isStretchWithOverflow="true">
                <reportElement x="35" y="0" width="270" height="18" uuid="cd8b4e46-0f50-4d9b-a2a8-2eeb0db90a93"/>
                <textElement verticalAlignment="Middle"><font size="8"/></textElement>
                <textFieldExpression><![CDATA[
                    ($F{urun_kod} == null ? "" : $F{urun_kod})
                    + "  "
                    + ($F{urun_aciklama} == null ? "" : $F{urun_aciklama})
                ]]></textFieldExpression>
            </textField>

            <textField pattern="#,##0.###">
                <reportElement x="305" y="0" width="55" height="18" uuid="1a64f983-1fda-4a64-8460-c1d4d4e52540"/>
                <textElement textAlignment="Right" verticalAlignment="Middle"><font size="8"/></textElement>
                <textFieldExpression><![CDATA[$F{miktar}]]></textFieldExpression>
            </textField>

            <textField>
                <reportElement x="360" y="0" width="55" height="18" uuid="d9d07f44-3e48-465f-8f2d-11b2a4e2f9b7"/>
                <textElement textAlignment="Center" verticalAlignment="Middle"><font size="8"/></textElement>
                <textFieldExpression><![CDATA[$F{birim} == null ? "" : $F{birim}]]></textFieldExpression>
            </textField>

            <textField>
                <reportElement x="415" y="0" width="70" height="18" uuid="f5f13bb7-522f-4f6a-9a47-81c4b2ecbe5f"/>
                <textElement textAlignment="Right" verticalAlignment="Middle"><font size="8"/></textElement>
                <textFieldExpression><![CDATA[
                    ($F{birim_fiyat} == null ? "" : new java.text.DecimalFormat("#,##0.00").format($F{birim_fiyat}))
                    + " "
                    + ($F{doviz} == null ? "" : $F{doviz})
                ]]></textFieldExpression>
            </textField>

            <textField>
                <reportElement x="485" y="0" width="70" height="18" uuid="47c6df54-9f6f-4c18-ae5a-7f3ea25a2a2b"/>
                <textElement textAlignment="Right" verticalAlignment="Middle"><font size="8"/></textElement>
                <textFieldExpression><![CDATA[
                    ($F{satir_tutar} == null ? "" : new java.text.DecimalFormat("#,##0.00").format($F{satir_tutar}))
                    + " "
                    + ($F{doviz} == null ? "" : $F{doviz})
                ]]></textFieldExpression>
            </textField>
        </band>
    </detail>

</jasperReport>